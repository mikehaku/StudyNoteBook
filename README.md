# StudyNoteBook
记录我的一些学习笔记

2025年7月8日 CUDA-SIFT和老代码的使用
最近在做基于无人机俯拍图像的汽车违停检测。考虑到无人机位置和速度数据2s才能返回一次，且可能与图像存在时间不对齐，因此考虑采用纯视觉对前后帧中地面的位移进行估计。
具体来说，使用特征匹配的方法，对地面特征点的像素位移进行估计。
我测试了ORB算子和SIFT算子，发现SIFT效果好于ORB，具体而言，是特征点的数量和匹配精度要高很多。但SIFT的缺点在于，使用python-opencv库时，即使用了高性能CPU，特征提取和匹配的速度依然很慢，多帧平均耗时0.77s，是一个准实时应用（每秒10帧）不可接受的速度。
因此，考虑使用之前用过的基于GPU的SIFT（在2022年做长短焦相机图像匹配时用过），可以实现非常高的计算速度。资源地址为https://github.com/Celebrandil/CudaSift
该项目虽然是纯C++构建的项目，但应该也可以使用Python加插件的方式使用。这次是不得不做这件事（之前觉得很高端，但又懒得去用，因为没有刚需）。
之前也看过几个类似的基于GPU的SIFT资源，但这些资源都有一些问题，就是年代比较早，都是几年前甚至十几年前的，使用了python2和一些非常旧的库，而现在（2025年）已经是CUDA12.2和gcc-11，显卡也是4090（sm_89架构），所以兼容性非常不好，出现很多“可以cmake ..,但make阶段报错”的情况。
此次遇到的这个CUDA-SIFT是2022年做其他项目时在RTX3090显卡（CUDA版本我忘记了）成功运行过的，效果还可以，因此考虑使用这个资源来构建应用。
在cmake ..阶段没有出问题，但在make阶段遇到两个编译错误，一个是“sm_35”不兼容的问题，一个是“gcc-6”不兼容的问题，但都可以通过在CMakeLists.txt中修改来规避错误。

pypopsift资源，地址https://github.com/OpenDroneMap/pypopsift
该资源的使用也存在一些问题，在2025.07.08上午解决，目前可以正常编译通过。
问题有以下几点：
1. 4年前的资源，最多只能针对sm_86架构，即RTX30x0系列显卡，其原生代码对sm_89的显卡不支持。处理方法是重新写资源的顶层CMakeLists.txt，让其可以兼容sm_89架构。
2. 资源自带了一个pybind11，但这个pybind11是2.5版本，远远落后于现在的2.13（现在甚至有3.0.0版本），因此其针对的python版本也较低，无法支持python3.12/3.13这样的新版本，因此需要下载pybind11的新的release版本源码，替换其初始的低版本pybind11。
3. 部分代码存在bug，主要是thurst库的一些依赖没有显式包含，需要添加s_filtergrid.cu文件里面的#include内容。
经过以上几处修改，才能保证make成功。
